<!DOCTYPE html>
<html>
<head>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta charset="utf-8"/>
<script src="https://www.geogebra.org/apps/deployggb.js"></script>

</head>
<body>
<div id="ggbApplet"></div>

<script>
var parameters = {
"id": "ggbApplet",
"width":800,
"height":400,
"showMenuBar":false,
"showAlgebraInput":false,
"showToolBar":true,
"customToolBar":"0 39 73 62 | 1 501 67 , 5 19 , 72 75 76 | 2 15 45 , 18 65 , 7 37 | 4 3 8 9 , 13 44 , 58 , 47 | 16 51 64 , 70 | 10 34 53 11 , 24 20 22 , 21 23 | 55 56 57 , 12 | 36 46 , 38 49 50 , 71 14 68 | 30 29 54 32 31 33 | 25 17 26 60 52 61 | 40 41 42 , 27 28 35 , 6 | 100016 100012 100013 100011 100002 100003 100004 100008 100007 100010 100009 100014 100015 100001 100006",
"showToolBarHelp":false,
"showResetIcon":false,
"enableLabelDrags":false,
"enableShiftDragZoom":true,
"enableRightClick":false,
"errorDialogsActive":false,
"useBrowserForJS":false,
"allowStyleBar":false,
"preventFocus":false,
"showZoomButtons":true,
"capturingThreshold":3,
// add code here to run when the applet starts
"appletOnLoad":function(api){ /* api.evalCommand('Segment((1,2),(3,4))');*/ },
"showFullscreenButton":true,
"scale":1,
"disableAutoScale":false,
"allowUpscale":false,
"clickToLoad":false,
"appName":"classic",
"buttonRounding":0.7,
"buttonShadows":false,
"language":"en",
// use this instead of ggbBase64 to load a material from geogebra.org
// "material_id":"RHYH3UQ8",
// use this instead of ggbBase64 to load a .ggb file
filename:"ggb/color2.ggb",
};
// is3D=is 3D applet using 3D view, AV=Algebra View, SV=Spreadsheet View, CV=CAS View, EV2=Graphics View 2, CP=Construction Protocol, PC=Probability Calculator DA=Data Analysis, FI=Function Inspector, macro=Macros
var views = {'is3D': 1,'AV': 0,'SV': 0,'CV': 0,'EV2': 0,'CP': 0,'PC': 0,'DA': 0,'FI': 0,'macro': 0};
var applet = new GGBApplet(parameters, '5.0', views);
window.onload = function() {applet.inject('ggbApplet')};
applet.setPreviewImage('data:image/gif;base64,R0lGODlhAQABAAAAADs=','https://www.geogebra.org/images/GeoGebra_loading.png','https://www.geogebra.org/images/applet_play.png');
</script>

<script>
parameters.appletOnLoad = function(api) {
var strLength = 150;
var textarea1 = document.getElementsByName("textarea1")[0];
var textarea2 = document.getElementsByName("textarea2")[0];
var consState = document.getElementsByName("consState")[0];
    function addListener(objName) { 
	    textarea1.value = "add: " + objName + "\n" + textarea1.value.substring(0, strLength );	
	    printConstructionState();
    }

    function removeListener(objName) {
	    textarea1.value = "remove: " + objName + "\n" + textarea1.value.substring(0, strLength );	
	    printConstructionState();
    }

    function renameListener(oldObjName, newObjName) {
	    textarea1.value = "rename: " + objName + "\n" + textarea1.value.substring(0, strLength );	
	    printConstructionState();
    }

    function updateListener(objName) {
	    strVal = api.getValueString(objName);
	    textarea2.value = strVal + "\n" + textarea2.value.substring(0, strLength );
    }

    function clearListener() {
	    textarea1.value = "";
	    textarea2.value = "";
	    textarea1.value = "construction cleared";
	    consState.value = "";
    }

    function printConstructionState() {
	    var objNumber = api.getObjectNumber();
	    var strState = "Number of objects: " + objNumber;
	    for (i=0; i < objNumber; i++) {
		    strName = api.getObjectName(i);
		    strType = api.getObjectType(strName);
		    strCommand = api.getCommandString(strName);
		    strState += "\n" + strType + " " + strName + ", " + strCommand;
	    }
	    consState.value = strState;
  }
	// register add, remove, rename and update listeners
	api.registerAddListener(addListener);
	api.registerRemoveListener(removeListener);
	api.registerRenameListener(renameListener);
	api.registerClearListener(clearListener);
	api.registerUpdateListener(updateListener);
}

       var applet = new GGBApplet({filename:"ggb/color2.ggb","showtoolbar":true},true);
   //  var applet = new GGBApplet(parameters,true);
    //  when used with Math Apps Bundle, uncomment this:
        applet.setHTML5Codebase('GeoGebra/HTML5/5.0/web3d/');

	window.onload = function() {
               applet.inject('applet_container');
        }
 </script>
      <p></p>
<div id="applet_container"></div>
      

        <h5>Construction State Listening</h5>

        <div style="float: left;margin-right:24px" class="text">
	  <label>Update:</label>
			  <textarea class="inputfield" name="textarea2" cols="35" rows="5"></textarea>

			<label>Add, Remove, Rename:</label>
      	        <textarea class="inputfield" name="textarea1" cols="35" rows="5"></textarea>

		  </div>
		  <div style="float: left; padding-top:6px">
              <label>Current Construction State:</label>
              <textarea class="inputfield" style="height:250px" name="consState" cols="35" rows="14"></textarea>
        </div>
<style>label{display:block}</style>
</table>

</body>
</html>
